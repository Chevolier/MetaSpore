nohup: ignoring input
updating: common/ (stored 0%)
updating: common/neg_sampler.py (deflated 65%)
updating: common/__init__.py (deflated 38%)
updating: common/criteo_sparse_features_extractor.py (deflated 54%)
updating: common/ml_sparse_features_extractor.py (deflated 76%)
updating: common/__pycache__/ (stored 0%)
updating: common/__pycache__/ml_sparse_features_extractor.cpython-38.pyc (deflated 63%)
updating: common/__pycache__/__init__.cpython-38.pyc (deflated 19%)
24/07/07 08:41:21 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
24/07/07 08:41:23 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties
[Stage 7:>                                                                                                                    (0 + 32) / 162][Stage 7:==>                                                                                                                  (3 + 32) / 162][Stage 7:======================>                                                                                             (32 + 32) / 162][Stage 7:=======================>                                                                                            (33 + 32) / 162][Stage 7:===========================>                                                                                        (39 + 32) / 162][Stage 7:=============================================>                                                                      (64 + 32) / 162][Stage 7:==================================================>                                                                 (71 + 32) / 162][Stage 7:========================================================>                                                           (79 + 32) / 162][Stage 7:====================================================================>                                               (96 + 32) / 162][Stage 7:======================================================================>                                            (100 + 32) / 162][Stage 7:==============================================================================>                                    (111 + 32) / 162][Stage 7:==========================================================================================>                        (127 + 33) / 162][Stage 7:===============================================================================================>                   (134 + 28) / 162][Stage 7:=======================================================================================================>           (146 + 16) / 162][Stage 9:>                                                                                                                    (0 + 32) / 200][Stage 9:===>                                                                                                                 (6 + 32) / 200][Stage 9:===============>                                                                                                    (27 + 32) / 200][Stage 9:==================>                                                                                                 (32 + 32) / 200][Stage 9:====================>                                                                                               (36 + 32) / 200][Stage 9:=========================>                                                                                          (44 + 32) / 200][Stage 9:===============================>                                                                                    (55 + 32) / 200][Stage 9:==================================>                                                                                 (60 + 32) / 200][Stage 9:===================================>                                                                                (61 + 32) / 200][Stage 9:=====================================>                                                                              (64 + 32) / 200][Stage 9:======================================>                                                                             (66 + 32) / 200][Stage 9:========================================>                                                                           (70 + 32) / 200][Stage 9:============================================>                                                                       (76 + 33) / 200][Stage 9:=================================================>                                                                  (85 + 32) / 200][Stage 9:=====================================================>                                                              (92 + 32) / 200][Stage 9:=====================================================>                                                              (93 + 32) / 200][Stage 9:=======================================================>                                                            (95 + 32) / 200][Stage 9:========================================================>                                                           (97 + 32) / 200][Stage 9:========================================================>                                                           (98 + 32) / 200][Stage 9:=========================================================>                                                          (99 + 32) / 200][Stage 9:============================================================>                                                      (106 + 32) / 200][Stage 9:================================================================>                                                  (113 + 32) / 200][Stage 9:==================================================================>                                                (116 + 32) / 200][Stage 9:=======================================================================>                                           (124 + 32) / 200][Stage 9:========================================================================>                                          (126 + 32) / 200][Stage 9:==========================================================================>                                        (129 + 32) / 200][Stage 9:==========================================================================>                                        (130 + 32) / 200][Stage 9:============================================================================>                                      (133 + 32) / 200][Stage 9:==============================================================================>                                    (136 + 32) / 200][Stage 9:==================================================================================>                                (143 + 32) / 200][Stage 9:====================================================================================>                              (147 + 32) / 200][Stage 9:=====================================================================================>                             (149 + 32) / 200][Stage 9:=======================================================================================>                           (152 + 32) / 200][Stage 9:===========================================================================================>                       (159 + 32) / 200][Stage 9:============================================================================================>                      (161 + 32) / 200][Stage 9:=============================================================================================>                     (162 + 32) / 200][Stage 9:==============================================================================================>                    (165 + 32) / 200][Stage 9:==================================================================================================>                (172 + 28) / 200][Stage 9:=====================================================================================================>             (176 + 24) / 200][Stage 9:======================================================================================================>            (178 + 22) / 200][Stage 9:========================================================================================================>          (181 + 19) / 200][Stage 9:============================================================================================================>      (189 + 11) / 200][Stage 9:=================================================================================================================>  (196 + 4) / 200]                                                                                                                                             [Stage 13:>                                                                                                                   (0 + 32) / 600][Stage 13:>                                            (0 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:>                                            (4 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:>                                           (13 + 33) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:==>                                         (32 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:==>                                         (35 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===>                                        (42 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===>                                        (48 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:====>                                       (60 + 33) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:====>                                       (67 + 33) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=====>                                      (69 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=====>                                      (71 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:======>                                     (84 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:======>                                     (95 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=======>                                    (99 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=======>                                   (105 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=======>                                   (107 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:========>                                  (118 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=========>                                 (128 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=========>                                 (133 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=========>                                 (136 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:==========>                                (141 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:==========>                                (153 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===========>                               (155 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===========>                               (160 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:============>                              (173 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:============>                              (180 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=============>                             (183 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=============>                             (187 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:==============>                            (199 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:==============>                            (207 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===============>                           (213 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===============>                           (218 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:================>                          (230 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=================>                         (238 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=================>                         (240 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=================>                         (250 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:==================>                        (252 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:==================>                        (263 + 33) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===================>                       (272 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===================>                       (278 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:====================>                      (286 + 33) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:====================>                      (291 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=====================>                     (303 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=====================>                     (304 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:======================>                    (312 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:======================>                    (318 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=======================>                   (324 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:========================>                  (339 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:========================>                  (344 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:========================>                  (346 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=========================>                 (350 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:==========================>                (363 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:==========================>                (376 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===========================>               (377 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===========================>               (384 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===========================>               (389 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:============================>              (400 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:============================>              (404 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=============================>             (411 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:==============================>            (432 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===============================>           (435 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===============================>           (438 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:================================>          (447 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=================================>         (462 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=================================>         (466 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=================================>         (467 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:==================================>        (479 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===================================>       (491 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===================================>       (494 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:===================================>       (499 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:====================================>      (506 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=====================================>     (520 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=====================================>     (525 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:======================================>    (533 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:======================================>    (535 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=======================================>   (545 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=======================================>   (551 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:========================================>  (559 + 33) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:========================================>  (565 + 32) / 600][Stage 14:>                                               (0 + 0) / 1][Stage 13:=========================================> (575 + 25) / 600][Stage 14:>                                               (0 + 1) / 1][Stage 13:==========================================>(588 + 12) / 600][Stage 14:>                                               (0 + 1) / 1]                                                                                                                                             [Stage 15:>                                                                                                                   (0 + 32) / 162][Stage 15:=========>                                                                                                         (13 + 32) / 162][Stage 15:======================>                                                                                            (32 + 32) / 162][Stage 15:===============================>                                                                                   (45 + 32) / 162][Stage 15:============================================>                                                                      (63 + 32) / 162][Stage 15:=============================================>                                                                     (64 + 32) / 162][Stage 15:================================================>                                                                  (68 + 32) / 162][Stage 15:===================================================================>                                               (95 + 32) / 162][Stage 15:====================================================================>                                              (96 + 32) / 162][Stage 15:=========================================================================>                                        (104 + 32) / 162][Stage 15:======================================================================================>                           (123 + 32) / 162][Stage 15:==========================================================================================>                       (129 + 32) / 162][Stage 15:===================================================================================================>              (142 + 20) / 162]                                                                                                                                             [Stage 26:>                                            (0 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:>                                            (3 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==>                                         (30 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==>                                         (32 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==>                                         (34 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:====>                                       (56 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:====>                                       (62 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:====>                                       (66 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=====>                                      (71 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:======>                                     (83 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:======>                                     (91 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=======>                                   (101 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=======>                                   (105 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=======>                                   (111 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:========>                                  (121 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:========>                                  (122 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=========>                                 (127 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=========>                                 (138 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==========>                                (140 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==========>                                (149 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:===========>                               (159 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:============>                              (172 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:============>                              (180 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=============>                             (183 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==============>                            (196 + 33) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==============>                            (201 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==============>                            (203 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:===============>                           (213 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:===============>                           (215 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:===============>                           (220 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:================>                          (231 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:================>                          (237 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=================>                         (251 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==================>                        (254 + 33) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==================>                        (263 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==================>                        (265 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:===================>                       (277 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:====================>                      (292 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=====================>                     (295 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=====================>                     (296 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=====================>                     (301 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=====================>                     (306 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:======================>                    (312 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=======================>                   (326 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=======================>                   (329 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=======================>                   (334 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:========================>                  (343 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=========================>                 (351 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=========================>                 (356 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=========================>                 (359 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==========================>                (370 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:===========================>               (384 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:===========================>               (388 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:===========================>               (390 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:============================>              (397 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=============================>             (413 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=============================>             (415 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==============================>            (423 + 33) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==============================>            (432 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:===============================>           (441 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:===============================>           (446 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:================================>          (452 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=================================>         (465 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=================================>         (469 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=================================>         (472 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:==================================>        (485 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:===================================>       (491 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:===================================>       (495 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:===================================>       (502 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:====================================>      (509 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=====================================>     (523 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=====================================>     (527 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:======================================>    (542 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=======================================>   (547 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=======================================>   (551 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:========================================>  (559 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:========================================>  (568 + 32) / 600][Stage 27:>                                               (0 + 0) / 1][Stage 26:=========================================> (575 + 25) / 600][Stage 27:>                                               (0 + 1) / 1]                                                                                                                                             [Stage 28:==>                                                                                                                 (3 + 32) / 162][Stage 28:====================>                                                                                              (29 + 32) / 162][Stage 28:======================>                                                                                            (32 + 32) / 162][Stage 28:===============================>                                                                                   (44 + 32) / 162][Stage 28:=============================================>                                                                     (64 + 32) / 162][Stage 28:===============================================>                                                                   (67 + 32) / 162][Stage 28:========================================================>                                                          (79 + 32) / 162][Stage 28:====================================================================>                                              (96 + 32) / 162][Stage 28:======================================================================>                                           (100 + 32) / 162][Stage 28:===============================================================================>                                  (113 + 32) / 162][Stage 28:==========================================================================================>                       (128 + 32) / 162][Stage 28:===============================================================================================>                  (136 + 26) / 162][Stage 28:================================================================================================================>  (159 + 3) / 162][Stage 30:======>                                                                                                            (12 + 32) / 200][Stage 30:==================>                                                                                                (33 + 32) / 200][Stage 30:============================>                                                                                      (50 + 32) / 200][Stage 30:===================================>                                                                               (62 + 32) / 200][Stage 30:========================================>                                                                          (70 + 32) / 200][Stage 30:====================================================>                                                              (91 + 32) / 200][Stage 30:======================================================>                                                            (94 + 32) / 200][Stage 30:================================================================>                                                 (114 + 32) / 200][Stage 30:========================================================================>                                         (128 + 32) / 200][Stage 30:============================================================================>                                     (134 + 32) / 200][Stage 30:==============================================================================================>                   (166 + 32) / 200][Stage 30:===============================================================================================>                  (168 + 32) / 200][Stage 36:>                                                                                                                   (0 + 32) / 200][Stage 36:========>                                                                                                          (15 + 32) / 200][Stage 36:================>                                                                                                  (28 + 32) / 200][Stage 36:================>                                                                                                  (29 + 32) / 200][Stage 36:=================>                                                                                                 (31 + 32) / 200][Stage 36:==================>                                                                                                (32 + 32) / 200][Stage 36:==================>                                                                                                (33 + 32) / 200][Stage 36:============================>                                                                                      (50 + 32) / 200][Stage 36:===================================>                                                                               (62 + 32) / 200][Stage 36:======================================>                                                                            (67 + 32) / 200][Stage 36:===========================================>                                                                       (76 + 32) / 200][Stage 36:==================================================>                                                                (88 + 32) / 200][Stage 36:===================================================>                                                               (90 + 33) / 200][Stage 36:====================================================>                                                              (92 + 32) / 200][Stage 36:=====================================================>                                                             (93 + 32) / 200][Stage 36:=======================================================>                                                           (96 + 32) / 200][Stage 36:=========================================================>                                                        (100 + 32) / 200][Stage 36:============================================================>                                                     (107 + 32) / 200][Stage 36:===================================================================>                                              (118 + 32) / 200][Stage 36:======================================================================>                                           (123 + 32) / 200][Stage 36:=======================================================================>                                          (125 + 32) / 200][Stage 36:========================================================================>                                         (127 + 32) / 200][Stage 36:========================================================================>                                         (128 + 32) / 200][Stage 36:=========================================================================>                                        (129 + 32) / 200][Stage 36:===========================================================================>                                      (133 + 32) / 200][Stage 36:===============================================================================>                                  (139 + 32) / 200][Stage 36:======================================================================================>                           (151 + 32) / 200][Stage 36:========================================================================================>                         (156 + 32) / 200][Stage 36:=========================================================================================>                        (157 + 32) / 200][Stage 36:==========================================================================================>                       (158 + 32) / 200][Stage 36:==========================================================================================>                       (159 + 32) / 200][Stage 36:===========================================================================================>                      (160 + 32) / 200][Stage 36:===========================================================================================>                      (161 + 32) / 200][Stage 36:==============================================================================================>                   (165 + 32) / 200][Stage 36:==============================================================================================>                   (166 + 32) / 200][Stage 36:==================================================================================================>               (172 + 28) / 200][Stage 36:======================================================================================================>           (180 + 20) / 200][Stage 36:==========================================================================================================>       (187 + 13) / 200][Stage 36:=============================================================================================================>     (191 + 9) / 200][Stage 36:==============================================================================================================>    (192 + 8) / 200][Stage 36:==============================================================================================================>    (193 + 7) / 200][Stage 36:===============================================================================================================>   (194 + 6) / 200][Stage 36:=================================================================================================================> (197 + 3) / 200][Stage 36:=================================================================================================================> (198 + 2) / 200][Stage 36:==================================================================================================================>(199 + 1) / 200]                                                                                                                                             /home/ec2-user/anaconda3/envs/metaspore/lib/python3.8/site-packages/pyspark/sql/dataframe.py:329: FutureWarning: Deprecated in 2.0, use createOrReplaceTempView instead.
  warnings.warn("Deprecated in 2.0, use createOrReplaceTempView instead.", FutureWarning)
Debug -- Movielens 25M Feature Genearation
Debug -- conf: fg.yaml.dev verbose: True
Debug -- load config:  {'app_name': 'MovieLens 25M Feature Generation', 'local': False, 'executor_memory': '15G', 'executor_instances': '8', 'executor_cores': '6', 'default_parallelism': '600', 'max_reservation_rating_len': 1000, 'movies_path': 's3a://sagemaker-us-west-2-452145973879/datasets/movielens/ml-25m/movies.csv', 'ratings_path': 's3a://sagemaker-us-west-2-452145973879/datasets/movielens/ml-25m/ratings.csv', 'genome_path': 's3a://sagemaker-us-west-2-452145973879/datasets/movielens/ml-25m/genome-scores.csv', 'links_path': 's3a://sagemaker-us-west-2-452145973879/datasets/movielens/ml-25m/links.csv', 'fg_dataset_out_path': 's3a://sagemaker-us-west-2-452145973879/datasets/movielens/25m/fg/fg_dataset.parquet'}
Debug -- spark init
Debug -- version: 3.5.1
Debug -- applicaitonId: local-1720341682144
Debug -- uiWebUrl: http://ip-172-16-14-249.us-west-2.compute.internal:4040
Debug -- movies sample:
+--------+--------------------+--------------------+
|movie_id|               title|               genre|
+--------+--------------------+--------------------+
|       1|    Toy Story (1995)|Adventure|Animati...|
|       2|      Jumanji (1995)|Adventure|Childre...|
|       3|Grumpier Old Men ...|      Comedy|Romance|
|       4|Waiting to Exhale...|Comedy|Drama|Romance|
|       5|Father of the Bri...|              Comedy|
|       6|         Heat (1995)|Action|Crime|Thri...|
|       7|      Sabrina (1995)|      Comedy|Romance|
|       8| Tom and Huck (1995)|  Adventure|Children|
|       9| Sudden Death (1995)|              Action|
|      10|    GoldenEye (1995)|Action|Adventure|...|
+--------+--------------------+--------------------+
only showing top 10 rows

Debug -- ratings sample:
+-------+--------+------+----------+
|user_id|movie_id|rating| timestamp|
+-------+--------+------+----------+
|      1|     296|   5.0|1147880044|
|      1|     306|   3.5|1147868817|
|      1|     307|   5.0|1147868828|
|      1|     665|   5.0|1147878820|
|      1|     899|   3.5|1147868510|
|      1|    1088|   4.0|1147868495|
|      1|    1175|   3.5|1147868826|
|      1|    1217|   3.5|1147878326|
|      1|    1237|   5.0|1147868839|
|      1|    1250|   4.0|1147868414|
+-------+--------+------+----------+
only showing top 10 rows

Debug -- genome sample:
+--------+------+---------+
|movie_id|tag_id|relevance|
+--------+------+---------+
|       1|     1|  0.02875|
|       1|     2|  0.02375|
|       1|     3|   0.0625|
|       1|     4|  0.07575|
|       1|     5|  0.14075|
|       1|     6|  0.14675|
|       1|     7|   0.0635|
|       1|     8|  0.20375|
|       1|     9|    0.202|
|       1|    10|  0.03075|
+--------+------+---------+
only showing top 10 rows

Debug -- links sample:
+--------+-------+-------+
|movie_id|imdb_id|tmdb_id|
+--------+-------+-------+
|       1|0114709|    862|
|       2|0113497|   8844|
|       3|0113228|  15602|
|       4|0114885|  31357|
|       5|0113041|  11862|
|       6|0113277|    949|
|       7|0114319|  11860|
|       8|0112302|  45325|
|       9|0114576|   9091|
|      10|0113189|    710|
+--------+-------+-------+
only showing top 10 rows

Debug -- dataset sample:
+-------+--------+--------------------+--------------------+------+----------+----+
|user_id|movie_id|               title|               genre|rating| timestamp|year|
+-------+--------+--------------------+--------------------+------+----------+----+
|      1|     296| Pulp Fiction (1994)|Comedy|Crime|Dram...|   5.0|1147880044|1994|
|      1|     306|Three Colors: Red...|               Drama|   3.5|1147868817|1994|
|      1|     307|Three Colors: Blu...|               Drama|   5.0|1147868828|1993|
|      1|     665|  Underground (1995)|    Comedy|Drama|War|   5.0|1147878820|1995|
|      1|     899|Singin' in the Ra...|Comedy|Musical|Ro...|   3.5|1147868510|1952|
|      1|    1088|Dirty Dancing (1987)|Drama|Musical|Rom...|   4.0|1147868495|1987|
|      1|    1175| Delicatessen (1991)|Comedy|Drama|Romance|   3.5|1147868826|1991|
|      1|    1217|          Ran (1985)|           Drama|War|   3.5|1147878326|1985|
|      1|    1237|Seventh Seal, The...|               Drama|   5.0|1147868839|1957|
|      1|    1250|Bridge on the Riv...| Adventure|Drama|War|   4.0|1147868414|1957|
+-------+--------+--------------------+--------------------+------+----------+----+
only showing top 10 rows

Debug -- movielens-25m generate_sparse_features_25m sparse features cost time: 20.941921710968018
Debug -- movielens-25m generate_sparse_features_25m result sample:
+-----+-------+--------+--------------------+--------------------+--------------------+----+--------------------+------+----------+--------------------+----------+
|label|user_id|movie_id|    recent_movie_ids| recent_movie_genres|  recent_movie_years|year|               genre|rating|last_movie|          last_genre| timestamp|
+-----+-------+--------+--------------------+--------------------+--------------------+----+--------------------+------+----------+--------------------+----------+
|    1|     28|    2407|15841676139621...|Drama|Sci-FiActi...|19971997199219...|1985|       ComedySci-Fi|   5.0|      2011|AdventureComedy...| 951086565|
|    1|     50|    1485|42392702044473...|Crime|DramaDrama...|20011998200120...|1997|              Comedy|   4.0|      8873|     AdventureDrama|1402505640|
|    1|     76|    1959|27977022293189...|Comedy|Drama|Fant...|19882000198920...|1985|       DramaRomance|   5.0|      6283|ActionAnimation...|1346219995|
|    1|     89|    4025|52991249401420...|Comedy|RomanceAc...|20021990200019...|2000|        ComedyCrime|   2.0|      5377|ComedyDramaRomance|1266622235|
|    1|    138|   54190|35346502516625...|DramaAction|Horr...|20002002200720...|2007|DramaFantasyMus...|   3.5|     47518|              Comedy|1304212514|
|    1|    139|    3730|48732648574603...|Animation|Drama|F...|20011983200319...|1974|       DramaMystery|   2.0|     64839|               Drama|1267737879|
|    1|    139|   72226|38304648393730...|DocumentaryDrama...|20052008197419...|2009|AdventureAnimati...|   3.5|     71462|         Documentary|1272394121|
|    1|    157|    3580|42264225473743...|Mystery|Thriller...|20002001200120...|2000|               Drama|   2.0|      4234|      DramaThriller|1010325964|
|    1|    180|  109487|585591157131013...|Action|Crime|Dram...|20082015201320...|2014|         Sci-FiIMAX|   5.0|    111759|  ActionSci-FiIMAX|1454267431|
|    1|    185|    7438|77810791220422...|Comedy|Crime|Dram...|19961988198020...|2004|ActionDramaThri...|   4.0|      6874|ActionCrimeThri...|1191923657|
+-----+-------+--------+--------------------+--------------------+--------------------+----+--------------------+------+----------+--------------------+----------+
only showing top 10 rows

Debug -- movielens-25m generate_sparse_features_25m sparse features total cost time: 43.28567409515381
Debug -- write_fg_dataset_to_s3 cost time: 180.2977113723755
Debug -- spark stop
