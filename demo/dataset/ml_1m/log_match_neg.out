nohup: ignoring input
updating: common/ (stored 0%)
updating: common/neg_sampler.py (deflated 65%)
updating: common/__init__.py (deflated 38%)
updating: common/criteo_sparse_features_extractor.py (deflated 54%)
updating: common/ml_sparse_features_extractor.py (deflated 76%)
updating: common/__pycache__/ (stored 0%)
updating: common/__pycache__/ml_sparse_features_extractor.cpython-38.pyc (deflated 63%)
updating: common/__pycache__/__init__.cpython-38.pyc (deflated 19%)
updating: common/__pycache__/neg_sampler.cpython-38.pyc (deflated 51%)
24/07/07 11:40:14 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
24/07/07 11:40:14 WARN SparkConf: Note that spark.local.dir will be overridden by the value set by the cluster manager (via SPARK_LOCAL_DIRS in mesos/standalone/kubernetes and LOCAL_DIRS in YARN).
24/07/07 11:40:16 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties
[Stage 2:>                                                                                                                       (0 + 32) / 200][Stage 2:===================>                                                                                                   (32 + 32) / 200][Stage 2:===================>                                                                                                   (33 + 32) / 200][Stage 2:==============================>                                                                                        (51 + 32) / 200][Stage 2:============================================>                                                                          (74 + 32) / 200][Stage 2:===============================================================>                                                      (107 + 32) / 200][Stage 2:=========================================================================>                                            (124 + 33) / 200][Stage 2:=======================================================================================>                              (149 + 33) / 200][Stage 2:==========================================================================================================>           (181 + 19) / 200]                                                                                                                                                [Stage 9:===================>                                                                                                   (34 + 32) / 203][Stage 9:======================>                                                                                                (39 + 32) / 203][Stage 9:==========================================>                                                                            (72 + 32) / 203][Stage 9:=============================================================>                                                        (105 + 32) / 203][Stage 9:================================================================================>                                     (138 + 32) / 203][Stage 9:=================================================================================================>                    (167 + 33) / 203][Stage 9:===============================================================================================================>      (191 + 12) / 203][Stage 13:===================>                                                                                                  (33 + 32) / 200][Stage 13:======================================>                                                                               (66 + 32) / 200][Stage 13:===============================================================>                                                     (108 + 32) / 200][Stage 13:=====================================================================================>                               (147 + 32) / 200]                                                                                                                                                [Stage 25:============================>                                                                                         (48 + 32) / 200][Stage 25:================================================>                                                                     (82 + 32) / 200][Stage 25:======================================================================>                                              (121 + 32) / 200][Stage 25:=============================================================================================>                       (159 + 32) / 200][Stage 25:===================================================================================================================>  (196 + 4) / 200]                                                                                                                                                [Stage 32:===========================================>                                                                          (74 + 32) / 203][Stage 32:==============================================================>                                                      (109 + 32) / 203][Stage 32:==================================================================================>                                  (143 + 32) / 203][Stage 32:================================================================================================>                    (168 + 32) / 203][Stage 36:=========================================================================>                                           (126 + 32) / 200][Stage 36:=================================================================================================>                   (167 + 32) / 200]                                                                                                                                                [Stage 42:========================================>                                                                             (69 + 32) / 200][Stage 42:===========================================================>                                                         (102 + 32) / 200][Stage 42:================================================================>                                                    (110 + 32) / 200][Stage 42:====================================================================================>                                (144 + 32) / 200][Stage 42:=======================================================================================================>             (177 + 23) / 200][Stage 42:=====================================================================================================================>(199 + 1) / 200]                                                                                                                                                [Stage 49:===========================================>                                                                          (74 + 32) / 203][Stage 49:=============================================================>                                                       (107 + 32) / 203][Stage 49:==================================================================================>                                  (143 + 32) / 203][Stage 49:========================================================================================>                            (153 + 32) / 203][Stage 49:=================================================================================================================>    (195 + 8) / 203][Stage 53:>                                                                                                                      (0 + 32) / 200][Stage 53:>                                                                                                                      (1 + 32) / 200][Stage 53:=========================>                                                                                            (43 + 32) / 200][Stage 53:=========================================>                                                                            (71 + 32) / 200][Stage 53:===========================================================>                                                         (102 + 33) / 200][Stage 53:==================================================================================>                                  (141 + 32) / 200][Stage 53:==================================================================================================>                  (168 + 32) / 200][Stage 53:=====================================================================================================================>(199 + 1) / 200]                                                                                                                                                [Stage 55:=======================>                                                                                              (40 + 32) / 200][Stage 55:=======================================>                                                                              (67 + 33) / 200][Stage 55:=========================================================>                                                            (97 + 32) / 200][Stage 55:=========================================================================>                                           (126 + 32) / 200][Stage 55:===========================================================================================>                         (157 + 32) / 200][Stage 55:=============================================================================================================>       (188 + 12) / 200]                                                                                                                                                [Stage 62:======================>                                                                                               (39 + 32) / 203][Stage 62:========================================>                                                                             (69 + 32) / 203][Stage 62:=================================================>                                                                    (85 + 32) / 203][Stage 62:=================================================================>                                                   (114 + 32) / 203][Stage 62:===================================================================================>                                 (145 + 32) / 203][Stage 62:=====================================================================================================>               (176 + 27) / 203]                                                                                                                                                [Stage 71:==============================>                                                                                      (105 + 32) / 400][Stage 71:==================================================>                                                                  (172 + 32) / 400][Stage 71:=====================================================================>                                               (239 + 32) / 400][Stage 71:==========================================================================================>                          (311 + 32) / 400][Stage 71:==============================================================================================================>      (378 + 22) / 400]                                                                                                                                                [Stage 82:================>                            (144 + 32) / 400][Stage 83:>                                               (0 + 0) / 200][Stage 82:=======================>                     (205 + 32) / 400][Stage 83:>                                               (0 + 0) / 200][Stage 82:===============================>             (278 + 32) / 400][Stage 83:>                                               (0 + 0) / 200][Stage 82:======================================>      (338 + 32) / 400][Stage 83:>                                               (0 + 0) / 200][Stage 82:=============================================>(399 + 1) / 400][Stage 83:>                                              (0 + 32) / 200][Stage 83:==>                                                                                                                    (5 + 32) / 200][Stage 83:=====================>                                                                                                (37 + 32) / 200][Stage 83:=================================>                                                                                    (57 + 32) / 200][Stage 83:===================================================>                                                                  (88 + 32) / 200][Stage 83:=====================================================================>                                               (119 + 32) / 200][Stage 83:====================================================================================>                                (145 + 32) / 200][Stage 83:=========================================================================================================>           (181 + 19) / 200]                                                                                                                                                [Stage 90:===================>                                                                                                  (33 + 32) / 203][Stage 90:===================================>                                                                                  (61 + 34) / 203][Stage 90:================================================>                                                                     (84 + 32) / 203][Stage 90:==================================================================>                                                  (115 + 32) / 203][Stage 90:==================================================================================>                                  (144 + 32) / 203][Stage 90:====================================================================================================>                (175 + 28) / 203][Stage 94:=>                                                                                                                    (3 + 110) / 200][Stage 94:=======>                                                                                                             (12 + 169) / 200][Stage 94:====================================>                                                                                (63 + 137) / 200]                                                                                                                                                [Stage 101:================>                            (72 + 32) / 200][Stage 102:>                                              (0 + 0) / 200][Stage 101:=======================>                    (107 + 32) / 200][Stage 102:>                                              (0 + 0) / 200][Stage 101:==============================>             (140 + 32) / 200][Stage 102:>                                              (0 + 0) / 200][Stage 101:======================================>     (176 + 24) / 200][Stage 102:>                                              (0 + 8) / 200][Stage 102:=====>                                                                                                                (9 + 32) / 200][Stage 102:=======================>                                                                                             (41 + 32) / 200][Stage 102:==========================================>                                                                          (72 + 32) / 200][Stage 102:=====================>                       (95 + 32) / 200][Stage 104:>                                              (0 + 0) / 132][Stage 102:=========================>                  (118 + 32) / 200][Stage 104:>                                              (0 + 0) / 132][Stage 102:================================>           (148 + 32) / 200][Stage 104:>                                              (0 + 0) / 132][Stage 102:=======================================>    (180 + 20) / 200][Stage 104:============>                                (38 + 12) / 132]                                                                                                                                                [Stage 113:================>                                                                                                    (28 + 32) / 203][Stage 113:=======>                                     (34 + 32) / 203][Stage 116:>                                              (0 + 0) / 203][Stage 113:==============>                              (67 + 32) / 203][Stage 116:>                                              (0 + 0) / 203][Stage 113:=====================>                      (100 + 32) / 203][Stage 116:>                                              (0 + 0) / 203][Stage 113:=============================>              (134 + 32) / 203][Stage 116:>                                              (0 + 0) / 203][Stage 113:=====================================>      (172 + 31) / 203][Stage 116:>                                              (0 + 1) / 203][Stage 116:=>                                                                                                                    (2 + 32) / 203][Stage 116:======>                                                                                                              (12 + 32) / 203][Stage 116:========================>                                                                                            (43 + 32) / 203][Stage 116:============================================>                                                                        (77 + 32) / 203][Stage 116:=========================================================>                                                           (99 + 32) / 203][Stage 116:====================================================================>                                               (119 + 32) / 203][Stage 116:======================================================================================>                             (152 + 32) / 203][Stage 116:=========================================================================================================>          (184 + 19) / 203]                                                                                                                                                [Stage 128:================================>                                                                                   (169 + 32) / 600][Stage 128:=======================================>                                                                            (205 + 33) / 600][Stage 128:=====================================================>                                                              (278 + 32) / 600][Stage 128:===================================================================>                                                (349 + 32) / 600][Stage 128:===============================================================================>                                    (409 + 32) / 600][Stage 128:=========================================================================================>                          (463 + 32) / 600][Stage 128:=======================================================================================================>            (535 + 33) / 600][Stage 128:====================================================================================================================>(599 + 1) / 600]                                                                                                                                                [Stage 138:=======>             (74 + 32) / 200][Stage 143:>                      (0 + 0) / 400][Stage 144:>                      (0 + 0) / 200][Stage 138:===========>        (110 + 32) / 200][Stage 143:>                      (0 + 0) / 400][Stage 144:>                      (0 + 0) / 200][Stage 138:==============>     (145 + 32) / 200][Stage 143:>                      (0 + 0) / 400][Stage 144:>                      (0 + 0) / 200][Stage 138:==================> (180 + 20) / 200][Stage 143:>                     (2 + 12) / 400][Stage 144:>                      (0 + 0) / 200][Stage 143:==>                                          (22 + 32) / 400][Stage 144:>                                              (0 + 0) / 200][Stage 143:=======>                                     (66 + 32) / 400][Stage 144:>                                              (0 + 0) / 200][Stage 143:===========>                                (107 + 32) / 400][Stage 144:>                                              (0 + 0) / 200][Stage 143:=======>            (150 + 32) / 400][Stage 144:>                      (0 + 0) / 200][Stage 146:>                      (0 + 0) / 132][Stage 143:=========>          (192 + 32) / 400][Stage 144:>                      (0 + 0) / 200][Stage 146:>                      (0 + 0) / 132][Stage 143:============>       (240 + 32) / 400][Stage 144:>                      (0 + 0) / 200][Stage 146:>                      (0 + 0) / 132][Stage 143:=============>      (272 + 32) / 400][Stage 144:>                      (0 + 0) / 200][Stage 146:>                      (0 + 0) / 132][Stage 143:================>   (330 + 32) / 400][Stage 144:>                      (0 + 0) / 200][Stage 146:>                      (0 + 0) / 132][Stage 143:==================> (375 + 25) / 400][Stage 144:>                      (0 + 7) / 200][Stage 146:>                      (0 + 0) / 132][Stage 144:>                                             (4 + 32) / 200][Stage 146:>                                              (0 + 0) / 132][Stage 144:=======>                                     (35 + 32) / 200][Stage 146:>                                              (0 + 0) / 132][Stage 144:============>                                (54 + 32) / 200][Stage 146:>                                              (0 + 0) / 132][Stage 144:==================>                          (81 + 32) / 200][Stage 146:>                                              (0 + 0) / 132][Stage 144:=========================>                  (115 + 32) / 200][Stage 146:>                                              (0 + 0) / 132][Stage 144:================================>           (147 + 32) / 200][Stage 146:>                                              (0 + 0) / 132][Stage 144:=======================================>    (178 + 22) / 200][Stage 146:===>                                          (9 + 10) / 132][Stage 146:=========================================================================================================>          (120 + 12) / 132]                                                                                                                                                [Stage 155:===================>                                                                                                 (34 + 32) / 203][Stage 155:==============>                              (66 + 32) / 203][Stage 158:>                                              (0 + 0) / 203][Stage 155:=====================>                       (99 + 32) / 203][Stage 158:>                                              (0 + 0) / 203][Stage 155:=============================>              (135 + 32) / 203][Stage 158:>                                              (0 + 0) / 203][Stage 155:=====================================>      (172 + 31) / 203][Stage 158:>                                              (0 + 1) / 203][Stage 158:=>                                                                                                                    (2 + 32) / 203][Stage 158:======>                                                                                                              (12 + 32) / 203][Stage 158:=========================>                                                                                           (45 + 32) / 203][Stage 158:===============================>                                                                                     (55 + 32) / 203][Stage 158:==================================================>                                                                  (88 + 32) / 203][Stage 158:====================================================================>                                               (119 + 32) / 203][Stage 158:=======================================================================================>                            (153 + 32) / 203][Stage 158:=======================================================================================================>            (181 + 22) / 203][Stage 162:=======================>                                                                                             (41 + 45) / 200][Stage 162:===================================================================>                                                (117 + 52) / 200]                                                                                                                                                [Stage 171:======>                                                                                                              (14 + 34) / 250][Stage 171:===============>                                                                                                     (33 + 32) / 250][Stage 171:===========================================================>                                                        (129 + 32) / 250][Stage 171:============================================================================================>                       (200 + 32) / 250][Stage 171:=============================================================================================>                      (201 + 32) / 250][Stage 171:===========================================================================================================>        (232 + 18) / 250]                                                                                                                                                Debug -- MovieLens 1M Match Dataset
Debug -- conf: match_dataset_negsample_10.yaml.dev verbose: True
Debug -- load config:  {'app_name': 'MovieLens 1M Match Dataset', 'local': False, 'executor_memory': '10G', 'executor_instances': '4', 'executor_cores': '4', 'default_parallelism': '400', 'num_negs': 10, 'fg_dataset_path': 's3a://sagemaker-us-west-2-452145973879/datasets/movielens/1m/fg/fg_dataset.parquet', 'match_train_dataset_out_path': 's3a://sagemaker-us-west-2-452145973879/datasets/movielens/1m/negsample/num_negs_10/train.parquet', 'match_test_dataset_out_path': 's3a://sagemaker-us-west-2-452145973879/datasets/movielens/1m/negsample/num_negs_10/test.parquet', 'match_item_dataset_out_path': 's3a://sagemaker-us-west-2-452145973879/datasets/movielens/1m/negsample/num_negs_10/item.parquet'}
Debug -- spark init
Debug -- version: 3.5.1
Debug -- applicaitonId: local-1720352415005
Debug -- uiWebUrl: http://ip-172-16-14-249.us-west-2.compute.internal:4040
Debug -- read dataset sample:
+-----+-------+------+---+----------+-----+--------+--------------------+--------------------+--------------------+----+--------------------+------+----------+--------------------+---------+
|label|user_id|gender|age|occupation|  zip|movie_id|    recent_movie_ids| recent_movie_genres|  recent_movie_years|year|               genre|rating|last_movie|          last_genre|timestamp|
+-----+-------+------+---+----------+-----+--------+--------------------+--------------------+--------------------+----+--------------------+------+----------+--------------------+---------+
|    1|      2|     M| 56|        16|70072|    2194|30711244369912...|DramaComedy|Dram...|19871979198419...|1987|  ActionCrimeDrama|   4.0|      2268|         CrimeDrama|978299297|
|    1|      4|     M| 45|         7|02460|    2366|34684803527119...|DramaAction|Adve...|19611993198719...|1933|ActionAdventure...|   4.0|      1201|      ActionWestern|978294230|
|    1|      5|     M| 25|        20|55455|    2858|9192717908356...|Adventure|Childre...|19391989195919...|1999|        ComedyDrama|   4.0|      1127|ActionAdventure...|978241390|
|    1|      5|     M| 25|        20|55455|    2427|16831722194192...|Drama|Romance|Thr...|19971997199519...|1998|    ActionDramaWar|   5.0|      1733|       DramaRomance|978246450|
|    1|      5|     M| 25|        20|55455|    1527|19419213266272...|DramaSci-Fi|Thri...|19951998199219...|1997|       ActionSci-Fi|   3.0|      1909|MysterySci-FiTh...|978246479|
|    1|     10|     F| 35|         1|95370|    1967|59211041257108...|Action|Adventure|...|19891951198519...|1986|AdventureChildre...|   5.0|      1287|ActionAdventure...|978227442|
|    1|     10|     F| 35|         1|95370|    1918|24971586368821...|RomanceAction|Dr...|19991997198119...|1998|ActionComedyCri...|   3.0|      1513|              Comedy|978230230|
|    1|     11|     F| 25|         1|04093|    1732|23593572109317...|ComedyComedy|Rom...|19981994197919...|1998|ComedyCrimeMyst...|   4.0|       104|              Comedy|978903927|
|    1|     15|     M| 25|         7|22903|    3566|28413798276311...|ThrillerThriller...|19992000199919...|2000|        ComedyDrama|   2.0|      2424|      ComedyRomance|978197314|
|    1|     15|     M| 25|         7|22903|    1610|19231271473105...|ComedyDramaCrim...|19981991199519...|1990|     ActionThriller|   4.0|      1885|        ComedyDrama|978198169|
+-----+-------+------+---+----------+-----+--------+--------------------+--------------------+--------------------+----+--------------------+------+----------+--------------------+---------+
only showing top 10 rows

Debug -- neg_sampler.gen_sample_prob cost time: 8.552957534790039
Debug -- neg_sampler.negative_sampling item_list.size: 3704
Debug -- neg_sampler.negative_sampling dist_list.size: 3704
Debug -- negative_sampling.negative_sampling sampling map-reduce cost time: 6.550480842590332
Debug -- negative sampling cost time: 20.174228191375732
Debug -- negative sampling result size: 4672618
Debug -- negative sampling result:
+-----+-------+------+---+----------+-----+--------+--------------------+--------------------+--------------------+----+--------------------+------+----------+--------------------+
|label|user_id|gender|age|occupation|  zip|movie_id|    recent_movie_ids| recent_movie_genres|  recent_movie_years|year|               genre|rating|last_movie|          last_genre|
+-----+-------+------+---+----------+-----+--------+--------------------+--------------------+--------------------+----+--------------------+------+----------+--------------------+
|    0|   1600|     M| 35|         7|08234|      16|46652026941409...|Action|Comedy|War...|19931993199919...|1987|              Comedy|     0|      2088|AdventureComedy...|
|    0|   1600|     M| 35|         7|08234|       7|26281049155237...|Action|Adventure|...|19991996199719...|1994|ActionAdventure...|     0|      1792|     ActionThriller|
|    0|   1600|     M| 35|         7|08234|       6|24201173141636...|DramaDramaDrama...|19841989199619...|1992|        ComedyDrama|     0|      3707|               Drama|
|    0|   1600|     M| 35|         7|08234|       3|65010353525303...|DramaMusicalCom...|19961965198419...|1993|ComedyRomanceTh...|     0|      1346|              Horror|
|    0|   1600|     M| 35|         7|08234|      18|53718163707304...|Comedy|DramaCome...|19941997198619...|1993|      ComedyRomance|     0|       193|               Drama|
|    0|   1600|     M| 35|         7|08234|      20|35771934402562...|DramaDramaComed...|19881995199319...|1969|ActionComedyWes...|     0|      1079|              Comedy|
|    0|   1600|     M| 35|         7|08234|       1|20233712480306...|Action|Crime|Dram...|19901991199319...|1970|          ComedyWar|     0|       910|        ComedyCrime|
|    0|   1600|     M| 35|         7|08234|      22|30393210188335...|ComedyComedyCom...|19831982199819...|1979|ActionHorrorSci...|     0|      1198|    ActionAdventure|
|    0|   1600|     M| 35|         7|08234|      17|13731772264224...|Action|Adventure|...|19891998198319...|1997|ActionAdventure...|     0|      1556|ActionRomanceTh...|
|    0|   1600|     M| 35|         7|08234|       8|19561674336315...|DramaDrama|Roman...|19801985197319...|1998|               Drama|     0|      2872|ActionDramaFant...|
+-----+-------+------+---+----------+-----+--------+--------------------+--------------------+--------------------+----+--------------------+------+----------+--------------------+
only showing top 10 rows

Debug -- negative sampling total cost time: 35.62856650352478
Debug -- match train dataset size: 5654867
Debug -- match train types: [('label', 'string'), ('user_id', 'string'), ('gender', 'string'), ('age', 'string'), ('occupation', 'string'), ('zip', 'string'), ('movie_id', 'string'), ('recent_movie_ids', 'string'), ('recent_movie_genres', 'string'), ('recent_movie_years', 'string'), ('year', 'string'), ('genre', 'string'), ('last_movie', 'string'), ('last_genre', 'string')]
Debug -- match train dataset sample:
[Stage 172:======================================>                                                                              (65 + 32) / 200][Stage 172:=========================================================>                                                           (99 + 32) / 200][Stage 172:=============================================================================>                                      (134 + 32) / 200][Stage 172:======================================================================================================>             (177 + 23) / 200]                                                                                                                                                [Stage 184:====================================>                                                                                (62 + 32) / 200][Stage 184:===========================================================>                                                        (103 + 32) / 200][Stage 184:=================================================================================>                                  (140 + 32) / 200][Stage 184:===================================================================================================>                (171 + 29) / 200]                                                                                                                                                [Stage 192:==========================================================>                                                         (101 + 32) / 200][Stage 192:===============================================================================>                                    (137 + 32) / 200][Stage 192:======================================================================================================>             (177 + 23) / 200][Stage 192:====================================================================================================================>(199 + 1) / 200]                                                                                                                                                [Stage 198:===========================>                                                                                         (47 + 32) / 200][Stage 198:===================================================>                                                                 (88 + 32) / 200][Stage 198:=========================================================================>                                          (127 + 32) / 200][Stage 198:===================================================================================================>                (171 + 29) / 200]                                                                                                                                                +-----+-------+------+---+----------+-----+--------+--------------------+--------------------+--------------------+----+--------------------+----------+--------------------+
|label|user_id|gender|age|occupation|  zip|movie_id|    recent_movie_ids| recent_movie_genres|  recent_movie_years|year|               genre|last_movie|          last_genre|
+-----+-------+------+---+----------+-----+--------+--------------------+--------------------+--------------------+----+--------------------+----------+--------------------+
|    0|   6005|     F| 25|         5|28401|      25|20032167799278...|Comedy|HorrorAct...|19841998199619...|1984|              Horror|      2617|ActionAdventure...|
|    0|   3509|     M| 18|         4|02115|    3370|1097108091641...|Children's|Drama|...|19821995199619...|1994|       ActionSci-Fi|      2717|       ComedyHorror|
|    0|   1242|     F| 35|         0|10014|    3865|18112892373239...|DramaAction|Dram...|19971998199219...|1999|              Comedy|       232|        ComedyDrama|
|    0|   4248|     M| 25|         4|26508|    1417|16082912480592...|Action|ThrillerA...|19971999199319...|1986|      ActionRomance|      2273|     ActionThriller|
|    0|   2195|     M|  1|        10|60148|    1940|12594801544158...|Adventure|Comedy|...|19861993199719...|1986|AnimationChildre...|      2011|       ComedySci-Fi|
|    0|   5838|     F| 45|         7|02038|    2004|34712324128711...|Drama|Sci-FiCome...|19771997195919...|1946|               Drama|      3105|               Drama|
|    0|   3395|     M| 25|         7|02134|    1012|25022901256023...|Comedy|RomanceHo...|19991979199919...|1999|     ComedyThriller|      3176|DramaMysteryThr...|
|    0|   2144|     M| 18|         0|46517|    1646|3016301744161...|HorrorHorrorAct...|19821987199519...|1989|ActionAdventure...|      2420|               Drama|
|    1|   2427|     F| 25|        14|94010|    2394|36430342810594...|Animation|Childre...|19941973199719...|1998|   AnimationMusical|      2899|AdventureAnimati...|
|    0|   4958|     M| 18|         7|55403|    3535|13916742311133...|Action|Comedy|Sci...|19961968198419...|1979|ActionAdventure...|      1917|ActionAdventure...|
+-----+-------+------+---+----------+-----+--------+--------------------+--------------------+--------------------+----+--------------------+----------+--------------------+
only showing top 10 rows

Debug -- match test dataset size: 18120
Debug -- match test types: [('label', 'string'), ('user_id', 'string'), ('gender', 'string'), ('age', 'string'), ('occupation', 'string'), ('zip', 'string'), ('movie_id', 'string'), ('recent_movie_ids', 'string'), ('recent_movie_genres', 'string'), ('recent_movie_years', 'string'), ('year', 'string'), ('genre', 'string'), ('last_movie', 'string'), ('last_genre', 'string')]
Debug -- match test dataset sample:
+-----+-------+------+---+----------+----------+--------+--------------------+--------------------+--------------------+----+--------------------+----------+--------------------+
|label|user_id|gender|age|occupation|       zip|movie_id|    recent_movie_ids| recent_movie_genres|  recent_movie_years|year|               genre|last_movie|          last_genre|
+-----+-------+------+---+----------+----------+--------+--------------------+--------------------+--------------------+----+--------------------+----------+--------------------+
|    0|    329|     M| 35|         7|     02115|    3826|37027903882391...|ComedyHorrorCom...|19941981200020...|2000|HorrorSci-FiThr...|      3317|        ComedyDrama|
|    1|   3587|     M| 35|         3|     93611|    1201|35272971587137...|Action|Sci-Fi|Thr...|19871979199019...|1966|      ActionWestern|      2401|             Western|
|    1|    107|     M| 45|        18|     63129|    1674|14299339493230...|ActionComedy|Rom...|19961955195519...|1985|DramaRomanceThr...|      2949|              Action|
|    1|   1139|     M| 25|         1|93420-2852|    3317|37933159375538...|Action|Sci-FiAni...|20001999200020...|2000|        ComedyDrama|        40|               Drama|
|    1|    583|     F| 25|         0|     48067|    2122|18631224092642...|ComedyComedyAct...|19951995197919...|1984|     HorrorThriller|      2643|ActionAdventure...|
|    1|    582|     M| 18|         4|     67042|      42|26723798379386...|Drama|Sci-Fi|Thri...|19992000200019...|1995|  ActionCrimeDrama|      1246|               Drama|
|    1|   2683|     M| 35|         7|     60188|    2724|3392431537237...|Comedy|RomanceCo...|19951998199419...|1999|      ComedyRomance|      3174|        ComedyDrama|
|    0|   1056|     M|  1|         0|     48133|    2706|17561981197925...|HorrorHorrorHor...|19981989198619...|1999|              Comedy|       588|AnimationChildre...|
|    1|   4909|     F| 35|        12|     94014|    2926|21742150307233...|Comedy|FantasyCo...|19881980198719...|1988|        ComedyDrama|      2739|               Drama|
|    1|   4476|     M| 45|         1|     50588|    2407|26991573968245...|Action|Comedy|Sci...|19901997196819...|1985|       ComedySci-Fi|      1762|ActionHorrorSci-Fi|
+-----+-------+------+---+----------+----------+--------+--------------------+--------------------+--------------------+----+--------------------+----------+--------------------+
only showing top 10 rows

Debug -- match item dataset size: 3706
Debug -- match item types: [('label', 'string'), ('user_id', 'string'), ('gender', 'string'), ('age', 'string'), ('occupation', 'string'), ('zip', 'string'), ('movie_id', 'string'), ('recent_movie_ids', 'string'), ('recent_movie_genres', 'string'), ('recent_movie_years', 'string'), ('year', 'string'), ('genre', 'string'), ('last_movie', 'string'), ('last_genre', 'string')]
Debug -- match item dataset sample:
[Stage 201:=====>               (50 + 32) / 200][Stage 206:>                      (0 + 0) / 400][Stage 207:>                      (0 + 0) / 200][Stage 201:=========>           (88 + 32) / 200][Stage 206:>                      (0 + 0) / 400][Stage 207:>                      (0 + 0) / 200][Stage 201:=============>      (132 + 32) / 200][Stage 206:>                      (0 + 0) / 400][Stage 207:>                      (0 + 0) / 200][Stage 201:=================>  (170 + 30) / 200][Stage 206:>                      (0 + 2) / 400][Stage 207:>                      (0 + 0) / 200][Stage 201:====================>(198 + 2) / 200][Stage 206:>                    (16 + 30) / 400][Stage 207:>                      (0 + 0) / 200][Stage 206:======>                                      (62 + 32) / 400][Stage 207:>                                              (0 + 0) / 200][Stage 206:===========>                                (104 + 32) / 400][Stage 207:>                                              (0 + 0) / 200][Stage 206:================>                           (151 + 32) / 400][Stage 207:>                                              (0 + 0) / 200][Stage 206:=========>          (185 + 32) / 400][Stage 207:>                      (0 + 0) / 200][Stage 209:>                      (0 + 0) / 132][Stage 206:============>       (242 + 32) / 400][Stage 207:>                      (0 + 0) / 200][Stage 209:>                      (0 + 0) / 132][Stage 206:==============>     (287 + 32) / 400][Stage 207:>                      (0 + 0) / 200][Stage 209:>                      (0 + 0) / 132][Stage 206:================>   (332 + 32) / 400][Stage 207:>                      (0 + 0) / 200][Stage 209:>                      (0 + 0) / 132][Stage 206:===================>(380 + 20) / 400][Stage 207:>                     (0 + 12) / 200][Stage 209:>                      (0 + 0) / 132][Stage 207:=>                                            (8 + 32) / 200][Stage 209:>                                              (0 + 0) / 132][Stage 207:=========>                                   (40 + 32) / 200][Stage 209:>                                              (0 + 0) / 132][Stage 207:===============>                             (69 + 32) / 200][Stage 209:>                                              (0 + 0) / 132][Stage 207:===================>                         (88 + 32) / 200][Stage 209:>                                              (0 + 0) / 132][Stage 207:==========================>                 (121 + 32) / 200][Stage 209:>                                              (0 + 0) / 132][Stage 207:================================>           (148 + 32) / 200][Stage 209:>                                              (0 + 0) / 132][Stage 207:=======================================>    (179 + 21) / 200][Stage 209:=======>                                     (23 + 12) / 132]                                                                                                                                                [Stage 218:>                                                                                                                     (0 + 32) / 203][Stage 218:>                                             (1 + 32) / 203][Stage 221:>                                              (0 + 0) / 203][Stage 218:=======>                                     (34 + 32) / 203][Stage 221:>                                              (0 + 0) / 203][Stage 218:==============>                              (66 + 32) / 203][Stage 221:>                                              (0 + 0) / 203][Stage 218:=====================>                      (100 + 32) / 203][Stage 221:>                                              (0 + 0) / 203][Stage 218:============================>               (133 + 32) / 203][Stage 221:>                                              (0 + 0) / 203][Stage 218:====================================>       (167 + 32) / 203][Stage 221:>                                              (0 + 0) / 203][Stage 221:=>                                                                                                                    (3 + 32) / 203][Stage 221:==>                                                                                                                   (5 + 32) / 203][Stage 221:=====================>                                                                                               (37 + 32) / 203][Stage 221:===================================>                                                                                 (61 + 32) / 203][Stage 221:============================================>                                                                        (77 + 32) / 203][Stage 221:==============================================================>                                                     (109 + 32) / 203][Stage 221:===============================================================================>                                    (139 + 32) / 203][Stage 221:=================================================================================================>                  (171 + 32) / 203][Stage 221:====================================================================================================================>(202 + 1) / 203][Stage 225:=====================================>                                                                               (64 + 46) / 200][Stage 225:======================================================================================>                             (149 + 42) / 200]                                                                                                                                                [Stage 234:============================================================================================>                       (200 + 32) / 250][Stage 234:==============================================================================================>                     (203 + 32) / 250][Stage 234:==============================================================================================================>     (239 + 11) / 250]                                                                                                                                                [Stage 252:====================================>                                                                                (79 + 32) / 250][Stage 252:========================================================>                                                           (122 + 32) / 250][Stage 252:=============================================================================>                                      (168 + 32) / 250][Stage 252:============================================================================================>                       (200 + 32) / 250][Stage 252:================================================================================================>                   (209 + 32) / 250][Stage 252:=============================================================================================================>      (235 + 15) / 250][Stage 262:>                                                                                                                     (0 + 32) / 200][Stage 262:=====>                                                                                                                (9 + 32) / 200][Stage 262:==================>                                                                                                  (32 + 32) / 200][Stage 262:==============================>                                                                                      (52 + 32) / 200][Stage 262:====================================>                                                                                (63 + 32) / 200][Stage 262:=====================================>                                                                               (64 + 32) / 200][Stage 262:======================================>                                                                              (66 + 32) / 200][Stage 262:==============================================>                                                                      (79 + 32) / 200][Stage 262:========================================================>                                                            (96 + 32) / 200][Stage 262:==========================================================>                                                         (100 + 32) / 200][Stage 262:================================================================>                                                   (112 + 32) / 200][Stage 262:==========================================================================>                                         (128 + 32) / 200][Stage 262:=============================================================================>                                      (134 + 32) / 200][Stage 262:=====================================================================================>                              (147 + 32) / 200][Stage 262:============================================================================================>                       (160 + 32) / 200][Stage 262:=============================================================================================>                      (161 + 32) / 200][Stage 262:=================================================================================================>                  (168 + 32) / 200][Stage 262:=======================================================================================================>            (179 + 21) / 200][Stage 262:=============================================================================================================>      (189 + 11) / 200][Stage 262:================================================================================================================>    (192 + 8) / 200][Stage 262:================================================================================================================>    (193 + 7) / 200]                                                                                                                                                [Stage 263:==============================>                                                                                      (52 + 32) / 200][Stage 263:====================================================>                                                                (90 + 32) / 200][Stage 263:========================================================================>                                           (125 + 32) / 200][Stage 263:============================================================================================>                       (160 + 32) / 200][Stage 263:====================================================================================================================>(199 + 1) / 200]                                                                                                                                                [Stage 277:>                                                                                                                        (0 + 4) / 4]                                                                                                                                                [Stage 278:===================================>                                                                                 (61 + 32) / 200][Stage 278:=================================================>                                                                   (84 + 32) / 200][Stage 278:========================================================================>                                           (125 + 32) / 200][Stage 278:=============================================================================================>                      (162 + 32) / 200][Stage 280:>                                                                                                                      (0 + 32) / 73][Stage 280:================================================>                                                                     (30 + 32) / 73][Stage 280:===================================================>                                                                  (32 + 32) / 73][Stage 280:====================================================================================>                                 (52 + 21) / 73][Stage 280:========================================================================================================>              (64 + 9) / 73]                                                                                                                                                /home/ec2-user/anaconda3/envs/metaspore/lib/python3.8/site-packages/pyspark/sql/dataframe.py:329: FutureWarning: Deprecated in 2.0, use createOrReplaceTempView instead.
  warnings.warn("Deprecated in 2.0, use createOrReplaceTempView instead.", FutureWarning)
/home/ec2-user/anaconda3/envs/metaspore/lib/python3.8/site-packages/pyspark/sql/dataframe.py:329: FutureWarning: Deprecated in 2.0, use createOrReplaceTempView instead.
  warnings.warn("Deprecated in 2.0, use createOrReplaceTempView instead.", FutureWarning)
+-----+-------+------+---+----------+-----+--------+--------------------+--------------------+--------------------+----+--------------------+----------+--------------------+
|label|user_id|gender|age|occupation|  zip|movie_id|    recent_movie_ids| recent_movie_genres|  recent_movie_years|year|               genre|last_movie|          last_genre|
+-----+-------+------+---+----------+-----+--------+--------------------+--------------------+--------------------+----+--------------------+----------+--------------------+
|    1|   1447|     M| 18|         4|80521|      26|89218841833202...|Comedy|Drama|Roma...|19961998199819...|1995|               Drama|      2002|ActionComedyCri...|
|    1|   1067|     M| 35|        12|94402|      29|99412311103129...|DramaDramaDrama...|19961983195519...|1995|    AdventureSci-Fi|      1214|ActionHorrorSci...|
|    1|   1880|     M| 35|         0|91006|      65|88324318551021...|ComedyComedyCom...|19961992199819...|1996|              Comedy|         4|        ComedyDrama|
|    1|   1737|     M| 35|        20|46614|     191|88019932412366...|Sci-Fi|ThrillerH...|19961992199019...|1995|               Drama|      1707|   Children'sComedy|
|    1|   5675|     M| 35|        14|30030|     222|9941393147432...|DramaDrama|Roman...|19961996199519...|1995|       DramaRomance|      1661|            Thriller|
|    1|   4472|     F| 45|        16|14424|     270|8522724914357...|Comedy|RomanceCo...|19961999196419...|1994|       DramaRomance|      1569|      ComedyRomance|
|    1|   1916|     M| 45|         7|90405|     293|99427501657107...|DramaComedy|Dram...|19961987199719...|1994|CrimeDramaRoman...|       909|        ComedyDrama|
|    1|    352|     M| 18|         4|60115|     418|99823564661100...|Action|CrimeCome...|19961998199319...|1993|               Drama|       725|              Comedy|
|    1|   5449|     M| 18|        12|01702|     474|96935273418363...|Action|Adventure|...|19511987199119...|1993|     ActionThriller|      1127|ActionAdventure...|
|    1|   3940|     M| 35|        20|32708|     541|99932721227377...|CrimeCrime|Drama...|19961992198419...|1982|    Film-NoirSci-Fi|      2987|AdventureAnimati...|
+-----+-------+------+---+----------+-----+--------+--------------------+--------------------+--------------------+----+--------------------+----------+--------------------+
only showing top 10 rows

Debug -- write_dataset_to_s3 train cost time: 131.67252278327942
Debug -- write_dataset_to_s3 test cost time: 5.274543523788452
Debug -- write_dataset_to_s3 item cost time: 35.09916615486145
Debug -- spark stop
